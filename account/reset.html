<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Reset Password ‚Äî Journeys Apparel</title>
    <meta name="description" content="Reset your Journey Apparel account password." />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body style="margin:0;overflow-x:hidden;background:#fff;color:#111">
    <header class="header" style="top:0;left:0;right:0">
      <div class="container header-inner" style="max-width:none;width:100%;padding-left:0;padding-right:16px">
        <div class="nav-left row">
          <button class="menu-toggle" aria-label="Open menu" style="background:transparent;border:none;padding:8px;display:inline-flex;flex-direction:column;gap:4px;align-items:center;justify-content:center;width:36px;height:36px;border-radius:0;box-shadow:none">
            <span style="display:block;width:22px;height:2px;background:#000;border-radius:1px"></span>
            <span style="display:block;width:22px;height:2px;background:#000;border-radius:1px"></span>
            <span style="display:block;width:22px;height:2px;background:#000;border-radius:1px"></span>
          </button>
          <nav class="nav" aria-label="Primary">
            <a href="/collection.html?collection=best-sellers" class="header-item">Best Sellers</a>
            <a href="/collection.html?section=new-arrivals" class="header-item">New Arrivals</a>
          </nav>
        </div>
        <h1 class="logo"><a href="/index.html" aria-label="Journeys Apparel Home" style="font-size:0.94em;letter-spacing:1.8px">JOURNEYS</a></h1>
        <div class="nav-right">
          <a id="headerProfileLink" class="icon-btn" aria-label="Account" href="#" style="order:1">üë§</a>
          <button class="icon-btn" aria-label="Search" style="order:2">üîç</button>
          <a class="icon-btn" aria-label="Cart" href="#" style="order:3">üõí</a>
        </div>
      </div>
    </header>

    <main class="container section" style="max-width:960px;margin:0 auto;padding:24px 16px 64px 16px">
      <section aria-label="Reset Password" style="margin:0 auto;border:1px solid #e5e5e5;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.06);padding:24px;max-width:720px;width:100%">
        <h1 class="upper" style="margin:0 0 8px 0;font-size:26px;font-weight:900;letter-spacing:0.5px">Reset password</h1>
        <p style="margin:0 0 16px 0;color:#666;font-size:14px">Enter a new password for your account.</p>
        <form id="reset-form" style="display:grid;grid-template-columns:1fr;gap:12px">
          <input type="hidden" name="id" />
          <input type="hidden" name="token" />
          <input type="hidden" name="reset_url" />
          <label style="display:flex;flex-direction:column;gap:6px"><span style="font-size:13px;color:#333">New password</span>
            <input name="password" type="password" required autocomplete="new-password" style="padding:12px;border:1px solid #ddd;border-radius:8px;font-size:14px" />
          </label>
          <label style="display:flex;flex-direction:column;gap:6px"><span style="font-size:13px;color:#333">Confirm password</span>
            <input name="confirm" type="password" required autocomplete="new-password" style="padding:12px;border:1px solid #ddd;border-radius:8px;font-size:14px" />
          </label>
          <button style="padding:12px 16px;border:1px solid #e5e5e5;background:#fff;border-radius:8px;font-weight:700;cursor:pointer">Set new password</button>
          <div data-form-message role="status" aria-live="polite" style="min-height:20px;font-size:13px;text-align:center;color:#666"></div>
        </form>
      </section>
    </main>

    <footer style="background:#fff;color:#111;margin-top:0">
      <div style="border-top:1px solid #333;padding:24px 0">
        <div style="max-width:1200px;margin:0 auto;padding:0 16px">
          <div style="display:flex;flex-direction:column;align-items:center;gap:16px;text-align:center">
            <div style="display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:24px">
              <span style="color:#000;font-size:14px">¬© 2025 Journey Apparel. All rights reserved. Prices in AUD.</span>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script src="/assets/account.js" defer></script>
    <script>
      (function(){
        function get(name){ var el=document.querySelector('[name="'+name+'"]'); return el?el.value:undefined; }
        function set(name,val){ var el=document.querySelector('[name="'+name+'"]'); if(el) el.value = val; }
        function setMsg(msg,color){ var m=document.querySelector('[data-form-message]'); if(!m) return; m.textContent=msg||''; if(color) m.style.color=color; }
        async function run(){
          try { JAAccount.setHeaderProfileLink(); } catch(_){ }
          var params = new URLSearchParams(location.search);
          var id = params.get('id');
          var token = params.get('token');
          var resetUrl = params.get('reset_url') || params.get('resetUrl');
          if (id) set('id', id);
          if (token) set('token', token);
          if (resetUrl) set('reset_url', resetUrl);
          var form = document.getElementById('reset-form');
          form.addEventListener('submit', async function(e){
            e.preventDefault();
            var pass = get('password');
            var confirm = get('confirm');
            if (!pass || pass !== confirm) { setMsg('Passwords do not match.','#c00'); return; }
            setMsg('Updating password...', '#666');
            try {
              var payload;
              if (get('reset_url')) {
                payload = { resetUrl: get('reset_url'), password: pass };
              } else if (get('id') && get('token')) {
                payload = { id: get('id'), resetToken: get('token'), password: pass };
              } else {
                setMsg('Missing reset parameters. Use the link from your email.', '#c00');
                return;
              }
              await JourneyAuth.resetPassword(payload);
              setMsg('Password updated. Redirecting...', '#0a0');
              setTimeout(function(){ location.replace('/account/index.html'); }, 1200);
            } catch(e) {
              setMsg((e && e.message) ? e.message : 'Reset failed.', '#c00');
            }
          });
        }
        document.addEventListener('DOMContentLoaded', run);
      })();
    </script>
    <script src="/script.js" defer></script>
  </body>
</html>

